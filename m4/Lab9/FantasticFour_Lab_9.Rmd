---
title: "Lab_09"
author: "Fantastic Four"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(nycflights13)
library(lubridate)
```
# Team Part (baseball)


# Individual Findings

## Lindsay Gettel
Section 13.5.1#3: Get the records for the most common vehicles from the fuel economy data set.
```{r, echo=FALSE}
library(tidyverse)
library(nycflights13)
library(forcats)
library(lubridate)
#13.5.1 Problem 3
fueleconomy::common
fueleconomy::vehicles
#get records for most common models
average_MPG<-semi_join(fueleconomy::vehicles, fueleconomy::common, by=c("make", "model"))%>%
  group_by(make, model)%>%
  mutate(avg_MPG=(hwy+cty)/2)%>%
  arrange(desc(avg_MPG))
```
The top three cars, based on highest average miles per gallons of highway and city driving, are the Ford Ranger pickup, Honda Insight, and the Toyota Prius.

Section 14.4.5.1#3: Switch the first and last letters for every word in the words data and compare and see which are still common words.
```{r, echo=FALSE}
#14.4.5.1 Problem 3
#switch first and last letters in words and determine which are still words
newWords<-str_replace(words, "^([A-Za-z])(.*)([A-Za-z])$", "\\3\\2\\1")
match<-str_subset(words, newWords)
match
```
Above are the words which remain common words even after switching the first and last letters.

Section 15.3.1#1: Consider the distribution of the reported incomes from the General Social survey.
```{r, echo=FALSE}
#15.3.1 Problem 1
fct_count(gss_cat$rincome)
newIncome<-fct_collapse(gss_cat$rincome, undelcared=c("No answer", "Don't know", "Refused"),
               Not_Applicable="Not applicable",
               high=c("$25000 or more", "$20000 - 24999", "$15000 - 19999"),
               medium=c("$10000 - 14999", "$15000 - 19999", "$20000 - 24999"),
               low=c("$5000 to 5999", "$6000 to 6999","$7000 to 7999", "$8000 to 9999"),
               bottom=c("Lt $1000","$1000 to 2999", "$3000 to 3999", "$4000 to 4999"))
ggplot(data=gss_cat)+ geom_bar(mapping=aes(x=newIncome, fill=gss_cat$rincome))+ coord_flip()
```
The graph above demonstrates how many people responded to having specific incomes in the survey.

Section 16.3.4#5: What day of the week is the best day to fly in order to minimize the amount of delays.
```{r}
#16.3.4 Problem 5
make_datetime_100 <- function(year, month, day, time){
  make_datetime(year, month, day, time %/% 100, time %% 100)}
flights_dt <- flights %>% 
  filter(!is.na(dep_time), !is.na(arr_time)) %>% 
  mutate(
    dep_time = make_datetime_100(year, month, day, dep_time),
    arr_time = make_datetime_100(year, month, day, arr_time),
    sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
    sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
  ) %>% 
  select(origin, dest, ends_with("delay"), ends_with("time"))
day_compare<-flights_dt%>%
  select(dep_delay, arr_delay, sched_dep_time, sched_arr_time)%>%
  mutate(day=wday(sched_dep_time))%>%
  group_by(day)%>%
  summarise(avg_dep_delay=mean(dep_delay), avg_arr_delay=mean(arr_delay, na.rm=TRUE))
print(day_compare)
```
The best day to fly with minimal delays is Sunday, it has the lowest arrival and the lowest departure delays.

## Lexie Marinelli
```{r, echo=FALSE}
#13.4 exercise number 4
  #What weather conditions make it more likely to see a delay?

flights %>%
  inner_join(weather, by= c("origin", "year", "month", "day", "hour")) %>%
  group_by(precip) %>%
  summarise(delay= mean(dep_delay, na.rm = TRUE)) %>%
  ggplot(aes(x= precip, y=delay)) + geom_smooth(se=FALSE) +geom_point()
```
You would think there would be a positive correlation but after 0.2 the trend doesn't show any relation between delay time and the amount it is raining. 

```{r, echo= FALSE}
# 14.5.1 number 2
# What are the five most common words in sentences?
str_extract_all(sentences, boundary("word")) %>%
  unlist() %>%
  str_to_lower()%>%
  tibble()%>%
  set_names("word") %>%
  group_by(word) %>%
  count(sort = TRUE)

```
The chart is pretty self explanatory, the top five words used in sentences are: the, a, of, to, & and.

```{r,echo=FALSE}
#15.5.1 number 1
#How have the proportions of people identifying as Democrat, Republican, and Independent changed over time?

gss_cat%>%
  mutate(partyid= fct_collapse(partyid, 
                             other= c("No answer", "Don't know", "Other party"),
                             rep=c("Strong republican", "Not str republican"), 
                             ind= c("Ind,near rep", "Independent", "Ind,near dem"),
                             dem= c("Not str democrat", "Strong democrat"))) %>%
  count (year, partyid) %>%
  group_by(year) %>%
  mutate(proportion= n/sum(n)) %>%
  ggplot(aes(x=year, y=proportion, color= partyid))+ geom_point() + geom_smooth(aes(color= partyid), se=FALSE) +labs(color= "Party ID") +ggtitle("Proportions of Political Parties Changing Over Time")
```
This plot shows us that over time the amount of people who consider themselves other have increases slightly, republicans have decreased slightly, democrats have been mostly stable and independent people have oscillated throughout the years.

```{r, echo= FALSE}
# 15.3.4 number 4
# How does the average delay time change over the course of a day?
make_datetime_100<- function(year, month, day, time) {
  make_datetime(year, month, day, time %/% 100, time %/% 100)
}
flights_dt <- flights %>%
  filter(!is.na(dep_time), !is.na(arr_time)) %>%
  mutate(
    dep_time= make_datetime_100(year, month, day, dep_time),
    arr_time= make_datetime_100(year, month, day, arr_time), 
    sched_dep_time= make_datetime_100(year, month, day, sched_dep_time),
    sched_arr_time= make_datetime_100(year, month, day, sched_arr_time)) %>%
  select(origin, dest, ends_with("delay"), ends_with("time"))

flights_dt %>%
  mutate(depHour= hour(sched_dep_time)) %>%
  group_by(depHour) %>%
  summarise(dep_delay= mean(dep_delay, na.rm=TRUE)) %>%
  ggplot(aes(x=depHour, y= dep_delay)) + geom_point() +geom_smooth(se=FALSE) + xlab(label= "Hour of Departure") + ylab(label = "Departure Delay") +ggtitle("Time of Day vs. Departure Delay")
```
As it gets later in the day, the number of departure delays increase which makes sense because as the morning flights get pushed back, people on the later flights will also be delayed because of what happens earlier in the day. 

## Scott Baker

## Zhenlong Li
```{r, warning=FALSE}
#13.4.6 #3
plane_ages <- 
  planes %>%
  mutate(age = 2013 - year) %>%
  select(tailnum, age)

flights %>%
  inner_join(plane_ages, by = "tailnum") %>%
  group_by(age) %>%
  filter(!is.na(dep_delay)) %>%
  summarise(delay = mean(dep_delay)) %>%
  ggplot(aes(x = age, y = delay)) + geom_jitter()
```
From the plot, we can see that there is no relationship between the age of a plane and its delays.

```{r}
#14.3.3 #5
x <- c("123-456-7890", "1234-5678")
str_view(x, "\\d\\d\\d-\\d\\d\\d-\\d\\d\\d\\d")
```


```{r}
#15.4.1 #1
summary(gss_cat[["tvhours"]])
gss_cat %>%
  filter(!is.na(tvhours)) %>%
  ggplot(aes(x = tvhours)) +
  geom_histogram(binwidth = 1)
```
I think the median will be a better summary. 

```{r}
#16.2.4 #1
parsing <- ymd(c("2010-10-10", "bananas")) 
parsing
```
It will produce an NA and a warning.

# Contributions
* Lindsay: Answered four textbook questions, using semi_join, str_subset, fct_collapse, and make_datetime. These were also combined with ggplot, and dplyr functions.

* Lexie: Created individual plots answering 4 textbook questions. For the tidyverse functions, I used: stringr, ggplot2, tibble, and forcats.

* Li: Finished four exercise from book. I used following functions: mutate, select, inner_join, group_by, filter, summarise, summary, str_view, geom_jitter and geom_histogram.

* Scott:
